<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Lua_api (ocaml-lua.Lua_api)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../index.html">ocaml-lua</a> &#x00BB; Lua_api</nav><h1>Module <code>Lua_api</code></h1><h2 id="the-lua-api-library-binding-in-ocaml-(read-this-first)"><a href="#the-lua-api-library-binding-in-ocaml-(read-this-first)" class="anchor"></a>The Lua API library binding in OCaml <b>(read this first)</b></h2><nav class="toc"><ul><li><a href="#introduction">Introduction</a><ul><li><a href="#note-on-thread-safety">Note on thread safety</a></li></ul></li><li><a href="#low-level-modules">Low level modules</a></li></ul></nav></header><section><header><h3 id="introduction"><a href="#introduction" class="anchor"></a>Introduction</h3></header><aside><p>This is the OCaml complete binding of the Lua Application Program Interface as described in the <a href="http://www.lua.org/manual/5.1/manual.html#3">official documentation</a>. The version of the library is the 5.1.5, the source code is available <a href="http://www.lua.org/versions.html#5.1">here</a> but, since it's a bug fix release, any version 5.1.x should be fine. On the other side, previous releases and the new Lua 5.2 is not supported.</p><p>The Lua API library is composed by two parts: the <a href="http://www.lua.org/manual/5.1/manual.html#3">low level API</a>, providing all the functions you need to interact with the Lua runtime, and the <a href="http://www.lua.org/manual/5.1/manual.html#4">auxiliary library</a>, described in the original documentation as follow:</p><p><i>The auxiliary library provides several convenient functions to interface C with Lua. While the basic API provides the primitive functions for all interactions between C and Lua, the auxiliary library provides higher-level functions for some common tasks. ... All functions in the auxiliary library are built on top of the basic API, and so they provide nothing that cannot be done with this API.</i></p><p>I included all the functions in the two libraries, with the exception of the <a href="http://www.lua.org/manual/5.1/manual.html#3.8">debug interface</a>, which is not planned because it's out of the intended scope of the OCaml binding. It could be added if anyone really needs it.</p><p>The signatures of the OCaml counterparts of the Lua functions where kept as close as possible to the original ones, to reduce at the minimum the mismatch between the two. This guideline lead to a very &quot;imperative&quot; OCaml library, but I think this is a minor issue.</p><p>Two &quot;low level&quot; modules are provided, <a href="../Lua_api_lib/index.html"><code>Lua_api_lib</code></a> and <a href="../Lua_aux_lib/index.html"><code>Lua_aux_lib</code></a>. Ideally you should start your program opening <code>Lua_api</code>, and then call functions like this:</p><pre><code class="ml">open Lua_api;;

let push_hello () =
  let ls = LuaL.newstate () in
  Lua.pushstring ls &quot;hello&quot;;
  ls
;;</code></pre><p>which is very close to what you would do in C:</p><pre><code class="ml">#include &lt;lua.h&gt;
#include &lt;lauxlib.h&gt;
#include &lt;lualib.h&gt;

lua_State* push_hello () {
    lua_State *L = luaL_newstate();
    lua_pushstring(L, &quot;hello&quot;);
    return L;
}</code></pre><p>Many functions, expecially in the <code>LuaL</code> module, are not real bindings, because sometimes it was faster to rewrite the function in OCaml than creating the binding. Every time this happens, it's clearly stated in the documentation. Other functions have different signatures or special notes, but all these differences are documented. At the top of the pages documenting the <a href="../Lua_api_lib/index.html"><code>Lua_api_lib</code></a> and <a href="../Lua_aux_lib/index.html"><code>Lua_aux_lib</code></a> modules there is a list of important differences.</p></aside><section><header><h4 id="note-on-thread-safety"><a href="#note-on-thread-safety" class="anchor"></a>Note on thread safety</h4></header><aside><p>This binding is to be considered &quot;thread safe&quot;. This means that you can use the library in a threaded setup, but keep in mind that you <b>cannot</b> share a Lua state <code>Lua_api_lib.state</code> between threads, because Lua itself doesn't allow this.</p></aside></section></section><section><header><h3 id="low-level-modules"><a href="#low-level-modules" class="anchor"></a>Low level modules</h3></header><dl><dt class="spec module" id="module-Lua"><a href="#module-Lua" class="anchor"></a><code><span class="keyword">module</span> Lua = <a href="../Lua_api_lib/index.html">Lua_api_lib</a></code></dt><dd><p>For reference see <a href="../Lua_api_lib/index.html"><code>Lua_api_lib</code></a></p></dd></dl><dl><dt class="spec module" id="module-LuaL"><a href="#module-LuaL" class="anchor"></a><code><span class="keyword">module</span> LuaL = <a href="../Lua_aux_lib/index.html">Lua_aux_lib</a></code></dt><dd><p>For reference see <a href="../Lua_aux_lib/index.html"><code>Lua_aux_lib</code></a></p></dd></dl></section></div></body></html>